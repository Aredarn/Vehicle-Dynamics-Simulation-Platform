<div class="track-builder">
  <div class="controls-panel">
    <h3>Track Builder</h3>
    
    <div class="control-group">
      <h4>Track Pieces</h4>
      <div class="palette">
        <div 
          *ngFor="let piece of palette" 
          class="palette-piece"
          draggable="true"
          (dragstart)="onDragStart($event, piece)"
          (dragend)="onDragEnd()"
          [title]="piece.label"
        >
          {{ piece.label }}
        </div>
      </div>
    </div>

    <div class="control-group">
      <h4>Simulation Controls</h4>
      <div class="button-group">
        <button (click)="startSimulation()" [disabled]="isSimulatingRunning">
          Start Simulation
        </button>
        <button (click)="stopSimulation()" [disabled]="!isSimulatingRunning">
          Stop
        </button>
        <button (click)="resetSimulation()">
          Reset
        </button>
        <button (click)="clearTrack()" class="danger">
          Clear Track
        </button>
      </div>
    </div>

    <div class="control-group">
      <h4>Display Options</h4>
      <div class="button-group">
        <button (click)="toggleRacingLine()">
          {{ showRacingLine ? 'Hide' : 'Show' }} Racing Line
        </button>
        <button (click)="toggleTurnDirection()">
          Curve: {{ currentTurnDirection }}
        </button>
      </div>
    </div>

    <div class="control-group" *ngIf="isSimulatingRunning">
      <h4>Simulation Info</h4>
      <div class="info-display">
        <p><strong>Speed:</strong> {{ carSpeed }}</p>
      </div>
    </div>

    <div class="control-group">
      <h4>Instructions</h4>
      <div class="instructions">
        <p>1. Drag "Start" piece to canvas first</p>
        <p>2. Add track pieces by dragging them</p>
        <p>3. Use "Curve" button to change turn direction</p>
        <p>4. Click "Start Simulation" to run</p>
      </div>
    </div>
  </div>

  <div class="canvas-container">
    <canvas 
      #canvas 
      width="1200" 
      height="800"
      (dragover)="onDragOver($event)"
      (dragenter)="onDragEnter($event)"
      (drop)="onDrop($event)"
    >
      Your browser does not support the canvas element.
    </canvas>
  </div>
</div>